require 'minitest/autorun'
require 'minitest/spec'
require 'pico_progressbar'

describe PicoProgress do
  let(:out_io) { StringIO.new }

  it 'prints a progress bar' do
    PicoProgress(1..10, out_io: out_io).each do |i|
      # noop
    end

    _(out_io.string).must_equal <<~EOS
⠙ 1 out of 10 (10%)...
\r\e[1A⠸ 2 out of 10 (20%)...
\r\e[1A⠴ 3 out of 10 (30%)...
\r\e[1A⠦ 4 out of 10 (40%)...
\r\e[1A⠇ 5 out of 10 (50%)...
\r\e[1A⠋ 6 out of 10 (60%)...
\r\e[1A⠙ 7 out of 10 (70%)...
\r\e[1A⠸ 8 out of 10 (80%)...
\r\e[1A⠴ 9 out of 10 (90%)...
\r\e[1A⠦ 10 out of 10 (100%)...
    EOS
  end
end
